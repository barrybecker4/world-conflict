<script>
var erisk = (function(my) {
    const { $, onClickOrTap } = domUtils;

    my.tutorialScreen = function(callback) {
        ['overview-panel', 'tutorial-button', 'sound'].map(id => domUtils.showOrHide(id, true));

        onClickOrTap($('cancel-button'), () => {
            erisk.setTutorialScreenVisibility(false);
            if (callback) {
                callback();
            }
        });
        onClickOrTap($('next'), () => switchTutorialCard(1));
        onClickOrTap($('prev'), () => switchTutorialCard(-1));

        onClickOrTap($('tutorial-button'), () => erisk.setTutorialScreenVisibility(true));
        onClickOrTap($('sound'), audio.toggleSound);
        onClickOrTap($('undo-button'), event => uiCallbacks.invokeCallback(0, 'undo', event));
        onClickOrTap($('restart'), () => {
            erisk.runSetupScreen();
            uiCallbacks.clearAll();
        });

        switchTutorialCard(0);
        setTimeout(() => erisk.setTutorialScreenVisibility(true), 10);
    }

    let currentCard = 0;
    let totalCards = 5;

    function switchTutorialCard(direction) {
        currentCard = utils.clamp(currentCard + direction, 0, totalCards-1);

        domUtils.setTransform($('tutorial-card'), "translate3d(" + (-currentCard * 100 / totalCards) + "%, 0, 0)");
        domUtils.showOrHide('prev', currentCard > 0);
        domUtils.showOrHide('next', currentCard < totalCards - 1);
    }

    my.setTutorialScreenVisibility = function(visible) {
        domUtils.setOverlayVisibility(visible, 'title-screen');
    }

    return my;
}(erisk || {}));
</script>